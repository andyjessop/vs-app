{"id":"../../../node_modules/@crux/state/dist/state.mjs","dependencies":[{"name":"/Users/andy/dev/crux/node_modules/@crux/state/dist/state.mjs.map","includedInParent":true,"mtime":1609665796040},{"name":"/Users/andy/dev/crux/examples/todo-list/package.json","includedInParent":true,"mtime":1609689731266},{"name":"/Users/andy/dev/crux/node_modules/@crux/state/package.json","includedInParent":true,"mtime":1608545196206}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createStore = createStore;\n\nfunction createSyncQueue() {\n  const entries = [];\n  let flushing = false;\n  return {\n    add,\n    flush\n  };\n\n  function add(fn, ...params) {\n    entries.push({\n      fn,\n      params\n    });\n  }\n\n  function flush() {\n    if (flushing) {\n      return;\n    }\n\n    const entry = entries.shift();\n\n    if (!entry) {\n      flushing = false;\n      return;\n    }\n\n    flushing = true;\n    entry.fn(...entry.params);\n\n    if (entries.length) {\n      return flush();\n    }\n  }\n}\n\nfunction createStore(initialState) {\n  const state = { ...initialState\n  };\n  const queue = createSyncQueue();\n  let paused = false;\n  const subscribers = [];\n  return {\n    pause,\n    resume,\n    state,\n    subscribe,\n    subscribers,\n    update\n  };\n\n  function subscribe(selector, callback) {\n    const initialValue = selector(state);\n    const newSubscriber = {\n      callback,\n      currentValue: initialValue,\n      selector\n    };\n    subscribers.push(newSubscriber);\n    return {\n      initialValue,\n      unsubscribe\n    };\n\n    function unsubscribe() {\n      const index = subscribers.indexOf(newSubscriber);\n\n      if (index !== -1) {\n        subscribers.splice(index, 1);\n      }\n    }\n  }\n\n  function notify() {\n    subscribers.forEach(subscriber => {\n      const newValue = subscriber.selector(state);\n\n      if (newValue !== subscriber.currentValue) {\n        queue.add(subscriber.callback, newValue);\n        subscriber.currentValue = newValue;\n      }\n    });\n\n    if (!paused) {\n      queue.flush();\n    }\n  }\n\n  function pause() {\n    paused = true;\n  }\n\n  function resume() {\n    paused = false;\n    queue.flush();\n  }\n\n  function update(callback) {\n    Object.assign(state, callback(state));\n    notify();\n  }\n}"},"sourceMaps":{"js":{"mappings":[{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":82,"column":0},"generated":{"line":8,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":82,"column":9},"generated":{"line":8,"column":9}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":82,"column":0},"generated":{"line":8,"column":24}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":82,"column":27},"generated":{"line":8,"column":27}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":83,"column":2},"generated":{"line":9,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":83,"column":8},"generated":{"line":9,"column":8}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":83,"column":15},"generated":{"line":9,"column":15}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":83,"column":18},"generated":{"line":9,"column":18}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":83,"column":2},"generated":{"line":9,"column":20}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":84,"column":2},"generated":{"line":10,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":84,"column":6},"generated":{"line":10,"column":6}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":84,"column":14},"generated":{"line":10,"column":14}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":84,"column":17},"generated":{"line":10,"column":17}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":84,"column":2},"generated":{"line":10,"column":22}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":85,"column":2},"generated":{"line":11,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":85,"column":9},"generated":{"line":11,"column":9}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":86,"column":4},"generated":{"line":12,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":86,"column":4},"generated":{"line":12,"column":4}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":85,"column":9},"generated":{"line":12,"column":7}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":87,"column":4},"generated":{"line":13,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":87,"column":4},"generated":{"line":13,"column":4}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":85,"column":9},"generated":{"line":14,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":85,"column":2},"generated":{"line":14,"column":3}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":89,"column":2},"generated":{"line":16,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":89,"column":11},"generated":{"line":16,"column":11}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":89,"column":2},"generated":{"line":16,"column":14}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":89,"column":15},"generated":{"line":16,"column":15}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":89,"column":2},"generated":{"line":16,"column":17}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":89,"column":19},"generated":{"line":16,"column":19}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":89,"column":22},"generated":{"line":16,"column":22}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":89,"column":2},"generated":{"line":16,"column":28}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":89,"column":30},"generated":{"line":16,"column":30}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":90,"column":4},"generated":{"line":17,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":90,"column":4},"generated":{"line":17,"column":4}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":90,"column":11},"generated":{"line":17,"column":11}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":90,"column":12},"generated":{"line":17,"column":12}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":90,"column":4},"generated":{"line":17,"column":16}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":90,"column":17},"generated":{"line":17,"column":17}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":91,"column":6},"generated":{"line":18,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":91,"column":6},"generated":{"line":18,"column":6}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":90,"column":17},"generated":{"line":18,"column":8}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":92,"column":6},"generated":{"line":19,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":92,"column":6},"generated":{"line":19,"column":6}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":90,"column":17},"generated":{"line":20,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":90,"column":4},"generated":{"line":20,"column":5}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":94,"column":3},"generated":{"line":21,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":95,"column":2},"generated":{"line":23,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":95,"column":11},"generated":{"line":23,"column":11}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":95,"column":2},"generated":{"line":23,"column":16}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":95,"column":19},"generated":{"line":23,"column":19}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":96,"column":4},"generated":{"line":24,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":96,"column":8},"generated":{"line":24,"column":8}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":96,"column":4},"generated":{"line":24,"column":16}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":96,"column":18},"generated":{"line":24,"column":18}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":97,"column":6},"generated":{"line":25,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":98,"column":5},"generated":{"line":26,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":99,"column":4},"generated":{"line":28,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":99,"column":10},"generated":{"line":28,"column":10}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":99,"column":15},"generated":{"line":28,"column":15}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":99,"column":18},"generated":{"line":28,"column":18}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":99,"column":25},"generated":{"line":28,"column":25}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":99,"column":26},"generated":{"line":28,"column":26}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":99,"column":18},"generated":{"line":28,"column":31}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":99,"column":4},"generated":{"line":28,"column":33}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":100,"column":4},"generated":{"line":30,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":100,"column":8},"generated":{"line":30,"column":8}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":100,"column":9},"generated":{"line":30,"column":9}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":100,"column":4},"generated":{"line":30,"column":14}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":100,"column":16},"generated":{"line":30,"column":16}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":101,"column":6},"generated":{"line":31,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":101,"column":6},"generated":{"line":31,"column":6}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":101,"column":14},"generated":{"line":31,"column":14}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":101,"column":17},"generated":{"line":31,"column":17}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":101,"column":6},"generated":{"line":31,"column":22}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":102,"column":6},"generated":{"line":32,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":103,"column":5},"generated":{"line":33,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":104,"column":4},"generated":{"line":35,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":104,"column":4},"generated":{"line":35,"column":4}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":104,"column":12},"generated":{"line":35,"column":12}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":104,"column":15},"generated":{"line":35,"column":15}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":104,"column":4},"generated":{"line":35,"column":19}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":4},"generated":{"line":36,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":4},"generated":{"line":36,"column":4}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":9},"generated":{"line":36,"column":9}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":10},"generated":{"line":36,"column":10}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":4},"generated":{"line":36,"column":12}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":13},"generated":{"line":36,"column":13}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":16},"generated":{"line":36,"column":16}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":21},"generated":{"line":36,"column":21}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":22},"generated":{"line":36,"column":22}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":105,"column":4},"generated":{"line":36,"column":28}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":106,"column":4},"generated":{"line":38,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":106,"column":8},"generated":{"line":38,"column":8}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":106,"column":15},"generated":{"line":38,"column":15}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":106,"column":16},"generated":{"line":38,"column":16}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":106,"column":4},"generated":{"line":38,"column":22}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":106,"column":24},"generated":{"line":38,"column":24}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":107,"column":6},"generated":{"line":39,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":107,"column":13},"generated":{"line":39,"column":13}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":107,"column":18},"generated":{"line":39,"column":18}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":107,"column":6},"generated":{"line":39,"column":20}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":108,"column":5},"generated":{"line":40,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":109,"column":3},"generated":{"line":41,"column":0}},{"source":"../../utils/dist/utils.mjs","name":null,"original":{"line":110,"column":0},"generated":{"line":42,"column":0}}],"sources":{"../../utils/dist/utils.mjs":"function createEventEmitter() {\n  const listeners = [];\n  return {\n    addListener,\n    emit,\n    removeListener,\n  };\n  function addListener(type, handler) {\n    const listener = { handler, type };\n    listeners.push(listener);\n  }\n  function emit(type, data) {\n    let listener;\n    const promises = [];\n    for (listener of listeners) {\n      if (listener.type !== type) {\n        continue;\n      }\n      const result = listener.handler(data);\n      if (result === null || result === void 0 ? void 0 : result.then) {\n        promises.push(result);\n      }\n    }\n    return Promise.all(promises);\n  }\n  function removeListener(type, handler) {\n    const ndx = listeners.findIndex((l) => type === l.type && handler === l.handler);\n    if (ndx !== -1) {\n      listeners.splice(ndx, 1);\n    }\n  }\n}\n\nfunction createAsyncQueue() {\n  const entries = [];\n  let flushing = false;\n  return {\n    add,\n    clear,\n    flush,\n  };\n  function add(fn, ...params) {\n    let rej = () => {};\n    let res = () => {};\n    const promise = new Promise((resolve, reject) => {\n      res = resolve;\n      rej = reject;\n    });\n    entries.push({\n      fn,\n      params,\n      reject: rej,\n      resolve: res,\n    });\n    return promise;\n  }\n  function clear() {\n    flushing = false;\n    entries.length = 0;\n  }\n  async function flush() {\n    if (flushing) {\n      return;\n    }\n    const entry = entries[0];\n    if (!entry) {\n      return;\n    }\n    flushing = true;\n    try {\n      const result = await entry.fn(...entry.params);\n      entry.resolve(result);\n      entries.shift();\n      flushing = false;\n      return flush();\n    } catch (e) {\n      entry.reject(e);\n    }\n  }\n}\n\nfunction createSyncQueue() {\n  const entries = [];\n  let flushing = false;\n  return {\n    add,\n    flush,\n  };\n  function add(fn, ...params) {\n    entries.push({\n      fn,\n      params,\n    });\n  }\n  function flush() {\n    if (flushing) {\n      return;\n    }\n    const entry = entries.shift();\n    if (!entry) {\n      flushing = false;\n      return;\n    }\n    flushing = true;\n    entry.fn(...entry.params);\n    if (entries.length) {\n      return flush();\n    }\n  }\n}\n\nexport { createAsyncQueue, createEventEmitter, createSyncQueue };\n//# sourceMappingURL=utils.mjs.map\n"},"lineCount":null}},"error":null,"hash":"e1e99fb73fbbd602ef61a4c03f54ce19","cacheData":{"env":{}}}